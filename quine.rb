def encode(prog)
  prog.unpack("H*")[0].to_i(16)
end

def decode(int)
  [int.to_s(16)].pack("H*")
end

def universal(prog_g, inputs)
  prog = decode(prog_g)
  args = "$x = " + inputs.to_s + "\n"
  $x_temp.push($x.dup)
  $x = []
  ans = eval(args + prog)
  $x = $x_temp.shift
  return ans
end

def smn(m, n, prog_g, inputs)
  init = "$x=[] unless $x\n"
  prog = decode(prog_g)
  args = "$x[#{m}, #{n}] = " + inputs[0, n].to_s + "\n"
  encode($Definition + init + args + prog)
end

def rec(prog_g, n)
  prog = decode(prog_g)
  f = <<~EOS
  $x[#{n}] = smn(#{n}, 1, $x[#{n}], [$x[#{n}]])
  #{prog}
  EOS
  f_g = encode(f)
  smn(n, 1, f_g, [f_g])
end
$x=[] unless $x
$x[0, 1] = [73368714713473251951331753824894510271858136819800121730402346518606713299682382518518573523297605255434767010475552658998738998782563186406452887381674791192942466839290570097248778116990453389432604803471074961812177438464264941392057781067831097064215165118468735684816376379854268218656737153638342259084255135710426818966275163939895251214819746932022224046399356995668278292067717785915479554400910907124658208385795042233777833660560711987849032370769442622043490281125600916696240304577320211523884156667091806559772691578253693272354604577114374598740412312757464336699479612762200215168853325058842739425094984607396070073899742464085154889714746393512585395468783533259426208240311712996477154135370621040781639011612058175347730350749224592923227119238306438015557184061235572979936699424133516734818677535790558279353363968442761691182155002946075282590216375345768561283842180222945637325499413064670219864479185190965440990914053656493769211025248049282878623108650125597839387476146563881459592902184383181474960028675539888627414937007585696262904476783095431105548720900002530135488081976096562239126325564333620809716047526916459416080338008147802251225126843750638072105103697187296103828452115341574548774496922112786768375489294078382168124639604342865366437158571109593083720959641650507340307988569594589198133921832581708080199351756262485313882283274298903604323320580435006879410286388567753609181838844304200831412618620805547681966911492589989290988014284036263008074600681937918020942469837482080776603744049516304614034784692606127661609141999239153079183989011995416551238076115582778127367859988798440210384325716700571097485013808541292827527412573142122413265945507436595881847061447890465700301836673720818731583682596860366999541277249647514208922528946288218059072872284942919241479230269156987583259544074]
$x[0] = smn(0, 1, $x[0], [$x[0]])
def encode(prog)
  prog.unpack("H*")[0].to_i(16)
end

def decode(int)
  [int.to_s(16)].pack("H*")
end

def universal(prog_g, inputs)
  prog = decode(prog_g)
  args = "$x = " + inputs.to_s + "\n"
  $x_temp.push($x.dup)
  $x = []
  ans = eval(args + prog)
  $x = $x_temp.shift
  return ans
end

def smn(m, n, prog_g, inputs)
  init = "$x=[] unless $x\n"
  prog = decode(prog_g)
  args = "$x[#{m}, #{n}] = " + inputs[0, n].to_s + "\n"
  encode($Definition + init + args + prog)
end

def rec(prog_g, n)
  prog = decode(prog_g)
  f = <<~EOS
  $x[#{n}] = smn(#{n}, 1, $x[#{n}], [$x[#{n}]])
  #{prog}
  EOS
  f_g = encode(f)
  smn(n, 1, f_g, [f_g])
end
universal(smn(0,1,42071388039436247639161438967828083643645777670646026,[$x[0]]),[])

